/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2021 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

document.getElementById("input").addEventListener("change",function(e){selectedFile=e.target.files[0]});var data=[{name:"jayanth",data:"scd",abc:"sdef"}];document.getElementById("button").addEventListener("click",function(){if(XLSX.utils.json_to_sheet(data,"out.xlsx"),selectedFile){var e=new FileReader;e.readAsBinaryString(selectedFile);var i=[];e.onload=function(e){var t=e.target.result,a=XLSX.read(t,{type:"binary"});console.log(a),a.SheetNames.forEach(function(e){var t=XLSX.utils.sheet_to_row_object_array(a.Sheets[e]);i.push(t)});var n=new Set;actions=[],i.forEach(function(e){e.forEach(function(e){actions.push(e),n.add(e["Rut Paciente"])})});var o=[];n.forEach(function(a){var n={rut:a,nombre:null,apellido:null,ultima:[]};actions.forEach(function(e){if("number"==typeof e["Fecha Cita"]){function t(e){e.getDate(),e.getMonth(),e.getFullYear().toString().slice(-2);return newdate}hoy=new Date,date=new Date(Math.round(86400*(e["Fecha Cita"]-25569)*1e3)),e["Fecha Cita"]=t(date),hoy=t(hoy)}a==e["Rut Paciente"]&&(n.nombre=e["Nombre paciente"],n.apellido=e["Apellidos paciente"],n.ultima.push([e.Profesional,e["Estado Cita"],e["Fecha Cita"]]))}),o.push(n)}),o.forEach(function(e){estado=e.ultima[0],"Anulado"!=estado[1]&&"No Asiste"!=estado[1]||console.log(e)})}}});
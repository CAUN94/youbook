/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2021 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

document.getElementById("input").addEventListener("change",function(e){selectedFile=e.target.files[0]});var data=[{name:"jayanth",data:"scd",abc:"sdef"}];function whatsapp(e){for(var t=e.Nombre+" "+e["Apellidos (Ingresar ambos)"],a=t.split(" "),n=0;n<a.length;n++)a[n]=a[n][0].toUpperCase()+a[n].substr(1);t=a.join(" ");var o=e.Nombre;a=o.split(" ");for(n=0;n<a.length;n++)a[n]=a[n][0].toUpperCase()+a[n].substr(1);o=a.join(" "),e["Teléfono"]=e["Teléfono"].toString(),e["Teléfono"]=e["Teléfono"].replace(/ /g,""),phone="569"+e["Teléfono"].substr(e["Teléfono"].length-8),mail="<a href=mailto:"+e.Mail+">"+e.Mail+"</a>";var r=e["Fecha Termino"],l=r.getMonth()+1,s=r.getDate();r.getFullYear();newdate=s+" - "+l,url="https://web.whatsapp.com/send?phone="+phone+"&text=Hola%20"+o+"%0A%0ATe%20queríamos%20recordar%20que%20tu%20suscripcion%20del%20tipo%20"+e["Tipo de Suscripción"]+"%20terminó%20el%20"+newdate+",%0Ano%20olvides%20renovarla%20en%20caso%20de%20que%20quieras%20seguir%20entrenando.%0A%0Asaludos,%0A%0AEquipo%20You",link="<a href='"+url+"' target='_blank'>+"+phone+"</a>",table.append("<tr><td>"+t+"</td><td>"+mail+"</td><td>"+link+"</td></tr>")}var list,rowObject=new Array,table=$("#studentsTable");table.find("tbody tr").remove(),document.getElementById("button").addEventListener("click",function(){if(XLSX.utils.json_to_sheet(data,"out.xlsx"),selectedFile){var e=new FileReader;e.readAsBinaryString(selectedFile),e.onload=function(e){var t=e.target.result,a=XLSX.read(t,{type:"binary",cellDates:!0});a.SheetNames.forEach(function(e){(list=XLSX.utils.sheet_to_row_object_array(a.Sheets[e])).forEach(function(e){rowObject.push(e)})}),rowObject.forEach(function(e){"Marca temporal"in e&&e["Días que Quedan"]<=0&&whatsapp(e)}),$("a").click(function(){console.log(2),$(this).parent().parent().addClass("bg-warning")})}}});